---
title: windows计划任务执行bat时如何隐藏cmd窗口
date: 2016-12-13 11:06:54
tags:
- windows计划任务
---

# 背景
在windows环境下，定时执行指定任务，最方便的就是创建一个windows自带的计划任务；
比如定期清理临时文件，我们可以创建一个bat脚本，然后通过计划任务执行这个脚本，到了设定的时间bat确实被执行了；
但是有个问题，每次执行bat时都会弹出一个cmd的窗口，执行完毕后又自动关闭，这样的体验非常不好，不知道的人还以为中毒了呢；
那么今天我就教大家如何消除这个“黑框”；

<!--more-->

# 原因和解决办法
要解决这个问题，首先要搞清楚出现cmd窗口的原因；
其实原因非常简单
1. windows系统其实有很多个用户（可以在“计算机管理”->"本地用户和组"中看到所有用户），当前登录的用户只是其中一个；
2. 每个windows执行计划需要配置一个运行的用户（在创建/编辑计划任务窗口中的“安全选项中”）
讲到这里，聪明的你应该想到了，出现cmd窗口是因为我们设置了当前登录用户为计划任务的执行用户；

原因找到了，解决起来就非常简单了，只需要将计划任务的执行用户修改为SYSTEM用户即可；

注意：计划任务属性中还有一个选项，控制是用户登录后才执行，还是不管用户是否登录都执行，注意别选错啦；

